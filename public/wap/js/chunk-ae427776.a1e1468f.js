(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ae427776"],{"0a90":function(t,s,i){var e=i("63b6"),o=i("10ff");e(e.G+e.F*(parseFloat!=o),{parseFloat:o})},"10ff":function(t,s,i){var e=i("e53d").parseFloat,o=i("a1ce").trim;t.exports=1/e(i("e692")+"-0")!==-1/0?function(t){var s=o(String(t),3),i=e(s);return 0===i&&"-"==s.charAt(0)?-0:i}:e},"13c8":function(t,s,i){var e=i("c3a1"),o=i("36c3"),a=i("355d").f;t.exports=function(t){return function(s){var i,n=o(s),r=e(n),c=r.length,p=0,l=[];while(c>p)a.call(n,i=r[p++])&&l.push(t?[i,n[i]]:n[i]);return l}}},"1af6":function(t,s,i){var e=i("63b6");e(e.S,"Array",{isArray:i("9003")})},"297d":function(t,s,i){},"2d1f":function(t,s,i){t.exports=i("b606")},"2fdb":function(t,s,i){"use strict";var e=i("5ca1"),o=i("d2c8"),a="includes";e(e.P+e.F*i("5147")(a),"String",{includes:function(t){return!!~o(this,t,a).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"32a6":function(t,s,i){var e=i("241e"),o=i("c3a1");i("ce7e")("keys",function(){return function(t){return o(e(t))}})},"355d":function(t,s){s.f={}.propertyIsEnumerable},"469f":function(t,s,i){i("6c1c"),i("1654"),t.exports=i("7d7b")},5147:function(t,s,i){var e=i("2b4c")("match");t.exports=function(t){var s=/./;try{"/./"[t](s)}catch(i){try{return s[e]=!1,!"/./"[t](s)}catch(o){}}return!0}},"59ad":function(t,s,i){t.exports=i("7be7")},"5d73":function(t,s,i){t.exports=i("469f")},6762:function(t,s,i){"use strict";var e=i("5ca1"),o=i("c366")(!0);e(e.P,"Array",{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("includes")},"6ad5":function(t,s,i){"use strict";i.r(s);var e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"confirm-order"},[i("navbar",{attrs:{text:"提交订单"}}),t.datas.goods_id||t.datas.id?i("scroller",[t.address?i("div",{staticClass:"m-list order-line",on:{click:t.jump}},[i("div",{staticClass:"m-list__l"},[t._v(t._s(t.address.truename))]),i("div",{staticClass:"m-list__c"},[i("p",{},[t._v(t._s(t.address.mobile))]),i("p",{staticClass:"f-font-sm"},[t._v(t._s(t.address.address+t.address.address_detail))])]),i("div",{staticClass:"m-list__r"},[i("i",{staticClass:"iconfont icon-fanhui right"})])]):i("div",{staticClass:"m-list link",on:{click:t.jump}},[i("div",{staticClass:"m-list__l"},[t._v("填写地址")]),i("div",{staticClass:"m-list__c"}),i("i",{staticClass:"iconfont icon-fanhui right"})]),t._l(t.goodsList,function(s,e){return i("div",{key:e,staticClass:"switch-card"},[i("div",{staticClass:"switch-card__hd"},[i("p",{staticClass:"switch-card__tt"},[3==s.key?[i("van-radio-group",{staticClass:"switch-card__radio",model:{value:s.type,callback:function(i){t.$set(s,"type",i)},expression:"item.type"}},[i("van-radio",{attrs:{name:"1"}},[t._v("邮寄")]),i("van-radio",{attrs:{name:"2"}},[t._v("自提")])],1)]:i("van-radio-group",{staticClass:"switch-card__radio",attrs:{"data-index":e},model:{value:s.type,callback:function(i){t.$set(s,"type",i)},expression:"item.type"}},[1==s.type?i("van-radio",{attrs:{name:"1"}},[t._v("邮寄")]):t._e(),2==s.type?i("van-radio",{attrs:{name:"2"}},[t._v("自提")]):t._e()],1)],2),i("i",{staticClass:"iconfont icon-fanhui iconfont",class:s.arrowDir,attrs:{"data-index":e},on:{click:t.toggleArrow}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:"top"==s.arrowDir,expression:"item.arrowDir == 'top'"}],staticClass:"switch-card__bd"},[i("router-link",{staticClass:"goods-line",attrs:{to:"/goods_detail/"+s.id}},[i("img",{staticClass:"u-goods__img",attrs:{src:s.cover}}),i("div",{staticClass:"goods-line__right"},[i("p",{staticClass:"u-goods__tt overflow-dot"},[1==t.datas.event_type?i("span",{staticClass:"s-red"},[t._v("【拼团】")]):2==t.datas.event_type?i("span",{staticClass:"s-red"},[t._v("【秒杀】")]):3==t.datas.event_type?i("span",{staticClass:"s-red"},[t._v("【砍价】")]):t._e(),t._v("\n            "+t._s(s.title))]),i("div",{staticClass:"goods-line__ft"},[i("div",{staticClass:"goods-line__price"},[i("span",[t._v("¥"+t._s(s.sale_price))]),i("span",{staticClass:"goods__price-cost f-font-sm"},[t._v("¥"+t._s(s.market_price))])]),i("p",{staticClass:"f-font-sm"},[t._v("x"+t._s(s.num))])])])]),i("div",{staticClass:"m-list small"},[i("p",{staticClass:"m-list__c"},[t._v("商品金额:")]),i("p",[t._v("¥"+t._s(s.sale_price))])]),1==s.type?i("div",{staticClass:"m-list small"},[i("p",{staticClass:"m-list__c"},[t._v("邮费:")]),i("p",[t._v("+ ¥"+t._s(s.express))])]):t._e()],1)])}),t.couponNum>0?i("div",{staticClass:"m-list link",on:{click:t.togglePopup}},[i("div",{staticClass:"m-list__l"},[t._v("优惠券")]),""==t.couponName?i("p",{staticClass:"m-list__c"},[t._v("你有"+t._s(t.couponNum)+"张优惠劵,点击使用")]):i("p",{staticClass:"m-list__c"},[t._v(t._s(t.couponName))]),i("i",{staticClass:"iconfont icon-fanhui right"})]):t._e(),t.isShop?i("div",{staticClass:"m-list link",on:{click:t.toggleShopPopup}},[i("div",{staticClass:"m-list__l"},[t._v("选择门店")]),i("p",{staticClass:"m-list__c"},[t._v(t._s(t.shopName))]),i("i",{staticClass:"iconfont icon-fanhui right"})]):t._e(),i("div",{staticClass:"m-input g-flex"},[i("span",{staticClass:"m-input__lable"},[t._v("买家留言:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.remark,expression:"remark"}],staticClass:"g-flex__item",attrs:{type:"text",placeholder:"点击给卖家留言"},domProps:{value:t.remark},on:{input:function(s){s.target.composing||(t.remark=s.target.value)}}})]),i("div",{staticClass:"tcp"},[i("van-checkbox",{staticClass:"square-checkbox",attrs:{shape:"square"},model:{value:t.isTcp,callback:function(s){t.isTcp=s},expression:"isTcp"}},[t._v("我已同意")]),i("span",{staticClass:"s-link",on:{click:t.openTcpPopup}},[t._v("《客户协议》")])],1)],2):t._e(),t.datas.goods_id||t.datas.id?i("div",{staticClass:"bottom-bar g-flex"},[i("div",{staticClass:"g-flex__item g-flex"},[i("p",[t._v("实付款：")]),i("p",{staticClass:"s-red"},[t._v("¥"+t._s(t.totalPrice))]),i("p"),i("p",{staticClass:"f-font-sm"},[t._v("含运费")])]),i("button",{staticClass:"u-button u-button--primary",on:{click:t.submitOrder}},[t._v("提交订单")])]):t._e(),i("van-popup",{staticClass:"tcpPopup",model:{value:t.isTcpPopup,callback:function(s){t.isTcpPopup=s},expression:"isTcpPopup"}},[i("div",{staticClass:"tcpPopup-box",domProps:{innerHTML:t._s(t.tcp)}})]),i("van-popup",{attrs:{position:"bottom"},on:{close:t.togglePopup},model:{value:t.isPopup,callback:function(s){t.isPopup=s},expression:"isPopup"}},[i("div",{staticClass:"coupon"},[i("div",{staticClass:"coupon-not"},t._l(t.couponList,function(s,e){return i("div",{key:e,staticClass:"coupon-item",attrs:{"data-index":e},on:{click:function(s){return t.selectCoupon(e)}}},[i("div",{staticClass:"coupon-item__l"},[i("span",{staticClass:"coupon-item__price"},[t._v(t._s(s.money))]),i("span",{staticClass:"f-font-sm"},[t._v("元")])]),i("div",{staticClass:"coupon-item__c"},[i("p",[t._v(t._s(s.title))]),i("p",{staticClass:"coupon-item__time"},[t._v(t._s(s.start_time)+"-"+t._s(s.end_time))])]),i("div",{staticClass:"coupon-item__r"},[i("button",{staticClass:"coupon-item__btn"},[t._v("使用")])])])}),0)])]),i("van-popup",{attrs:{position:"bottom"},on:{close:t.toggleShopPopup},model:{value:t.isShopPopup,callback:function(s){t.isShopPopup=s},expression:"isShopPopup"}},[i("van-radio-group",{model:{value:t.selfShopIdx,callback:function(s){t.selfShopIdx=s},expression:"selfShopIdx"}},[i("van-cell-group",t._l(t.shopList,function(s,e){return i("van-cell",{key:e,attrs:{title:s.name,clickable:""},on:{click:function(s){return t.selectShop(e)}}},[i("van-radio",{attrs:{name:e}})],1)}),1)],1)],1)],1)},o=[],a=i("768b"),n=i("5d73"),r=i.n(n),c=i("2d1f"),p=i.n(c),l=i("db0c"),u=i.n(l),d=i("a4bb"),f=i.n(d),h=(i("6762"),i("2fdb"),i("f499")),v=i.n(h),_=(i("7f7f"),i("e814")),m=i.n(_),g=i("59ad"),S=i.n(g),b=(i("ac6a"),i("ed08")),P=i("9d8d"),y=i("b970"),C=(i("18a0"),{data:function(){return{one:"1",tow:"2",datas:[],address:{},goodsList:[],totalPrice:0,tcp:"",isTcp:!0,isPopup:!1,isTcpPopup:!1,couponNum:0,couponName:"",couponMoney:0,couponList:[],isShopPopup:!1,shopList:[],selfShopIdx:-1,shopName:"点击选择门店",activeOrderParms:{},remark:"",goodsId:0,storesId:0,snId:0,sendType:1,sendTypeObj:{},isClickShop:0}},components:{navbar:P["a"]},computed:{isShop:function(){var t=this,s=!1,i=0,e=[];return this.goodsList.forEach(function(o,a){i=(S()(i)+S()(o.sale_price)*m()(o.num)+S()(o.express)).toFixed(2),e.push(o.type),t.sendTypeObj[o.id]=o.type,2==o.type&&(s=!0,i=(S()(i)-S()(o.express)).toFixed(2))}),this.totalPrice=S()(i),this.sendType=e.join(","),s},totalPrices:function(){}},methods:{openTcpPopup:function(){var t=this;this.isTcpPopup=!0,Object(b["c"])("shop/api/tcp").then(function(s){t.tcp=s.tcp})},jump:function(){this.$router.push({name:"address",params:{type:1}})},selectCoupon:function(t){this.couponName="-"+this.couponList[t].money+"元优惠劵",this.isPopup=!this.isPopup,this.totalPrice-=S()(this.couponList[t].money),this.totalPrice=this.totalPrice<0?0:this.totalPrice,this.couponMoney=S()(this.couponList[t].money),this.snId=this.couponList[t].sn_id},selectShop:function(t){this.shopName=this.shopList[t].name,this.storesId=this.shopList[t].id,this.isShopPopup=!this.isShopPopup},togglePopup:function(){this.isPopup=!this.isPopup;var t=this;1==this.isPopup&&Object(b["g"])("coupon/api/personal",{PHPSESSID:window.localStorage.getItem("PHPSESSID"),str_coupon_id:t.datas.str_coupon_id}).then(function(s){console.log(s),t.couponList=s.lists[0]})},toggleShopPopup:function(){var t=this;this.isShopPopup=!this.isShopPopup;var s=this.datas.allow_stores;1==this.isShopPopup&&Object(b["g"])("shop/api/shop_list",{PHPSESSID:window.localStorage.getItem("PHPSESSID"),is_choose:1,ids:s}).then(function(s){t.isClickShop=1,t.shopList=s.store_lists})},toggleArrow:function(t){console.log(t);var s=t.target.dataset.index||0,i=JSON.parse(v()(this.goodsList)),e=i[s].arrowDir;i[s].arrowDir="top"==e?"bottom":"top",this.goodsList=i},submitOrder:function(){var t=this,s=this,i=this.address;if(!i.mobile)return Object(y["d"])("请填写你的地址"),!1;if(!this.isTcp)return Object(y["d"])("请同意协议"),!1;if(this.sendType.includes(2)){if(1==this.isClickShop&&(!this.shopList||this.shopList.length<=0))return Object(y["d"])("商品没有共同的门店，请分开下单！"),!1;if(0==this.storesId)return Object(y["d"])("请选择配送门店"),!1}Object(b["g"])("shop/api/add_order",{address_id:s.address.id,remark:s.remark,sn_id:s.snId,stores_id:s.storesId,send_type:s.sendType,goods_send_type:s.sendTypeObj,openid:window.localStorage.getItem("openid"),is_weiapp:0,PHPSESSID:window.localStorage.getItem("PHPSESSID")}).then(function(s){if(0==s.code){var i=""!=s.msg?s.msg:"请求错误";Object(y["d"])(i)}else console.log("开始改善get请求"),Object(b["d"])(s.out_trade_no,t.totalPrice)})},shopListArr:function(t){var s=this,i=JSON.parse(v()(t)),e=(f.a,u.a,p.a),o=[],n=!0,c=!1,l=void 0;try{for(var d,h=function(){var t=Object(a["a"])(d.value,2),i=t[0],e=t[1];e.forEach(function(t,e){t.arrowDir="top",s.activeOrderParams&&(console.log(s.activeOrderParams),t.sale_price=JSON.parse(s.activeOrderParams).activePrice),3!=i?t.type=i:(t.type="1",console.log("item.type:",t.type),t.key=3),o.push(t)})},_=r()(e(i));!(n=(d=_.next()).done);n=!0)h()}catch(m){c=!0,l=m}finally{try{n||null==_.return||_.return()}finally{if(c)throw l}}this.goodsList=o},sendRequest:function(t){var s=this;Object(b["g"])("shop/api/confirm_order",t).then(function(t){0==t.code&&(console.log("错误了"),s.$router.push({name:"msg",params:{msg:t.msg,type:"warn"}})),s.datas=t,s.address=s.datas.address,s.couponNum=m()(s.datas.coupon_num),s.shopListArr(s.datas.lists)}).catch(function(t){console.log("错误信息："+t)})},getData:function(t){var s=this;if(this.activeOrderParams=this.$store.state.activeOrderParams,1==t){console.log(this.$route);var i={goods_ids:this.$route.params.goodsId,PHPSESSID:window.localStorage.getItem("PHPSESSID"),buyCount:this.$route.params.count,cart_ids:this.$route.params.cartIds};s.sendRequest(i)}else if(this.activeOrderParams){var e=JSON.parse(this.activeOrderParams);this.sendRequest(e),console.log("商品格格：",e.activePrice)}else{var o=this.$route.params.id;console.log(this.$route),this.goodsId=o;var a={goods_id:o,PHPSESSID:window.localStorage.getItem("PHPSESSID")};s.sendRequest(a)}}},created:function(){var t=this.$route.params.type;this.activeOrderParms=this.$store.state.activeOrderParams,this.getData(t),Object(b["i"])()},onShow:function(){0!=this.snId&&(this.totalPrice-=S()(_this.couponMoney))}}),x=C,L=(i("da12"),i("2877")),k=Object(L["a"])(x,e,o,!1,null,"35135f2e",null);s["default"]=k.exports},"768b":function(t,s,i){"use strict";var e=i("a745"),o=i.n(e);function a(t){if(o()(t))return t}var n=i("5d73"),r=i.n(n);function c(t,s){var i=[],e=!0,o=!1,a=void 0;try{for(var n,c=r()(t);!(e=(n=c.next()).done);e=!0)if(i.push(n.value),s&&i.length===s)break}catch(p){o=!0,a=p}finally{try{e||null==c["return"]||c["return"]()}finally{if(o)throw a}}return i}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function l(t,s){return a(t)||c(t,s)||p()}i.d(s,"a",function(){return l})},"7be7":function(t,s,i){i("0a90"),t.exports=i("584a").parseFloat},"7d6d":function(t,s,i){var e=i("63b6"),o=i("13c8")(!1);e(e.S,"Object",{values:function(t){return o(t)}})},"7d7b":function(t,s,i){var e=i("e4ae"),o=i("7cd6");t.exports=i("584a").getIterator=function(t){var s=o(t);if("function"!=typeof s)throw TypeError(t+" is not iterable!");return e(s.call(t))}},"8aae":function(t,s,i){i("32a6"),t.exports=i("584a").Object.keys},9003:function(t,s,i){var e=i("6b4c");t.exports=Array.isArray||function(t){return"Array"==e(t)}},"9c60":function(t,s,i){var e=i("63b6"),o=i("13c8")(!0);e(e.S,"Object",{entries:function(t){return o(t)}})},"9e1c":function(t,s,i){i("7d6d"),t.exports=i("584a").Object.values},a4bb:function(t,s,i){t.exports=i("8aae")},a745:function(t,s,i){t.exports=i("f410")},ac6a:function(t,s,i){for(var e=i("cadf"),o=i("0d58"),a=i("2aba"),n=i("7726"),r=i("32e9"),c=i("84f2"),p=i("2b4c"),l=p("iterator"),u=p("toStringTag"),d=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=o(f),v=0;v<h.length;v++){var _,m=h[v],g=f[m],S=n[m],b=S&&S.prototype;if(b&&(b[l]||r(b,l,d),b[u]||r(b,u,m),c[m]=d,g))for(_ in e)b[_]||a(b,_,e[_],!0)}},b606:function(t,s,i){i("9c60"),t.exports=i("584a").Object.entries},ce7e:function(t,s,i){var e=i("63b6"),o=i("584a"),a=i("294c");t.exports=function(t,s){var i=(o.Object||{})[t]||Object[t],n={};n[t]=s(i),e(e.S+e.F*a(function(){i(1)}),"Object",n)}},d2c8:function(t,s,i){var e=i("aae3"),o=i("be13");t.exports=function(t,s,i){if(e(s))throw TypeError("String#"+i+" doesn't accept regex!");return String(o(t))}},da12:function(t,s,i){"use strict";var e=i("297d"),o=i.n(e);o.a},db0c:function(t,s,i){t.exports=i("9e1c")},f410:function(t,s,i){i("1af6"),t.exports=i("584a").Array.isArray}}]);